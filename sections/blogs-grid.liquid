<section id="{{ section.id }}">
  {%- assign articles_per_page = 2 -%}
  {%- assign current_page = request.query.page | default: 1 | plus: 0 -%}

  {%- assign start_index = articles_per_page | times: current_page | minus: articles_per_page -%}
  {%- assign paged_articles = blog.articles | slice: start_index, articles_per_page -%}

  <ul>
    {%- for article in paged_articles -%}
      <li>
        <a href="{{ article.url }}">{{ article.title }}</a>
        {%- if article.tags.size > 0 -%}
          <span>
            â€”
            {%- for tag in article.tags -%}
              {{ tag }}
              {%- unless forloop.last -%}, {% endunless -%}
            {%- endfor -%}
          </span>
        {%- endif -%}
      </li>
    {%- endfor -%}
  </ul>

  {# --- Pagination links --- #}
  <div class="custom-pagination">
    {%- assign total_pages = blog.articles.size | divided_by: articles_per_page | ceil -%}

    {%- if current_page > 1 -%}
      <a href="?page={{ current_page | minus: 1 }}">Previous</a>
    {%- endif -%}

    {%- for i in (1..total_pages) -%}
      {%- if i == current_page -%}
        <span>{{ i }}</span>
      {%- else -%}
        <a href="?page={{ i }}">{{ i }}</a>
      {%- endif -%}
    {%- endfor -%}

    {%- if current_page < total_pages -%}
      <a href="?page={{ current_page | plus: 1 }}">Next</a>
    {%- endif -%}
  </div>
</section>

{% schema %}
{
  "name": "Simple Blog List",
  "settings": [
    {
      "type": "number",
      "id": "blogs_per_page",
      "label": "Number of articles to show",
      "default": 7
    }
  ],
  "presets": [
    {
      "name": "Simple Blog List"
    }
  ]
}
{% endschema %}
